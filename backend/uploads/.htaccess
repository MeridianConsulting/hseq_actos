# Configuración para servir archivos estáticos de uploads
# Permitir acceso directo a imágenes sin autenticación

# Habilitar mod_rewrite
RewriteEngine On

# Permitir acceso directo a archivos de imagen
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_URI} \.(jpg|jpeg|png|gif|webp|bmp|svg)$ [NC]
RewriteRule ^(.*)$ $1 [L]

# Configurar headers para imágenes
<IfModule mod_headers.c>
  # Cache para imágenes (1 semana)
  <FilesMatch "\.(jpg|jpeg|png|gif|webp|bmp|svg)$">
    Header set Cache-Control "public, max-age=604800, immutable"
    Header set Cross-Origin-Resource-Policy "cross-origin"
  </FilesMatch>
  
  # Denegar acceso a otros tipos de archivo
  <FilesMatch "\.(pdf|doc|docx|mp4|webm|ogg|txt|log|sql|env|ini|config)$">
    Header set Cache-Control "no-store"
    Require all denied
  </FilesMatch>
</IfModule>

# Configurar tipos MIME
<IfModule mod_mime.c>
  AddType image/jpeg .jpg .jpeg
  AddType image/png .png
  AddType image/gif .gif
  AddType image/webp .webp
  AddType image/bmp .bmp
  AddType image/svg+xml .svg
</IfModule>

# Denegar acceso a archivos sensibles
<FilesMatch "\.(htaccess|htpasswd|env|sql|ini|log|bak|config|yml|yaml)$">
  Require all denied
</FilesMatch>