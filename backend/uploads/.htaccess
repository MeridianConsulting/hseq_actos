# Habilitar mod_rewrite
RewriteEngine On

# Permitir acceso directo a archivos PHP para pruebas
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_URI} \.php$ [NC]
RewriteRule ^(.*)$ $1 [L]

# Redirigir todas las solicitudes de imágenes a través de index.php para aplicar CORS
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_URI} \.(jpg|jpeg|png|gif|webp|bmp|svg)$ [NC]
RewriteRule ^(.*)$ index.php [L,QSA]

# Denegar acceso directo a otros archivos potencialmente sensibles
<FilesMatch "\.(pdf|doc|docx|mp4|webm|ogg)$">
	Require all denied
</FilesMatch>

<IfModule mod_headers.c>
	# Evitar cache para tipos denegados (por si algún proxy los entrega)
	<FilesMatch "\.(pdf|doc|docx|mp4|webm|ogg)$">
		Header set Cache-Control "no-store"
	</FilesMatch>
</IfModule>